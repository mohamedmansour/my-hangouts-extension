/*
 * Copyright (c) 2010-2011 Martin Matysiak
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 * If you like my software, I would appreciate if you could send me a postcard.
 * You'll find my current address at http://martin-matysiak.de/en/sitenotice
 */
function getLatLngPerPixel(a){var b=360/(256*Math.pow(2,a));var c=2*b/Math.PI;return new google.maps.LatLng(c,b)}function SimpleMarker(a,b,c){this.map_=a;this.position_=b;this.bounds_=new Array;if(!c){c={}}this.ID_=c.id?c.id:null;this.image_="url("+(c.image?c.image:"http://www.google.com/intl/en_us/mapfiles/ms/micons/red-dot.png")+")";this.dimension_=c.dimension?c.dimension:new google.maps.Size(32,32);this.anchor_=c.anchor?c.anchor:new google.maps.Point(this.dimension_.width/2,this.dimension_.height);this.classname_=c.classname?c.classname:"";this.title_=c.title?c.title:"";this.setMap(a)}SimpleMarker.prototype=new google.maps.OverlayView;SimpleMarker.prototype.onAdd=function(){var a=this;var b=document.createElement("div");b.style.position="absolute";b.style.cursor="pointer";b.id=this.ID_?this.ID_:"";b.className=this.classname_;b.title=this.title_;b.style.backgroundImage=this.image_;b.style.width=this.dimension_.width+"px";b.style.height=this.dimension_.height+"px";this.getPanes().overlayImage.appendChild(b);this.marker_=b;var c=function(b){google.maps.event.trigger(a,"click");b.cancelBubble=true;if(b.stopPropagation){b.stopPropagation()}};if(b.attachEvent){b.attachEvent("onclick",c)}else{b.addEventListener("click",c,false)}};SimpleMarker.prototype.onRemove=function(){this.marker_.parentNode.removeChild(this.marker_);this.marker_=null};SimpleMarker.prototype.draw=function(){var a=this.getProjection();var b=a.fromLatLngToDivPixel(this.position_);this.marker_.style.left=b.x-this.anchor_.x+"px";this.marker_.style.top=b.y-this.anchor_.y+"px"};SimpleMarker.prototype.getPosition=function(){return this.position_};SimpleMarker.prototype.setPosition=function(a){this.position_=a;this.bounds_=new Array;this.draw()};SimpleMarker.prototype.getID=function(){return this.ID_};SimpleMarker.prototype.getBounds=function(a){if(!a){a=this.map_.getZoom()}if(!this.bounds_[a]){var b=getLatLngPerPixel(a);this.bounds_[a]=new google.maps.LatLngBounds(new google.maps.LatLng(this.position_.lat()+b.lat()*(this.anchor_.y-this.dimension_.height),this.position_.lng()-b.lng()*this.anchor_.x),new google.maps.LatLng(this.position_.lat()+b.lat()*this.anchor_.y,this.position_.lng()-b.lng()*(this.anchor_.x-this.dimension_.width)))}return this.bounds_[a]};SimpleMarker.prototype.setVisible=function(a){if(this.marker_){this.marker_.style.display=a?"block":"none"}}
